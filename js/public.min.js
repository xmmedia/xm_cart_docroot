var cart_public_app={models:{},views:{},collections:{}};Backbone.emulateHTTP=!0;Backbone.emulateJSON=!0;cart_public_app.models.order=Backbone.Model.extend({});cart_public_app.models.order_product=Backbone.Model.extend({url:"save_products"});cart_public_app.collections.order_products=Backbone.Collection.extend({model:cart_public_app.models.order_product});cart_public_app.views.add_product=Backbone.View.extend({events:{submit:"add_product"},add_product:function(e){e.preventDefault();var cart_product_id=parseInt(this.$el.find(".js_cart_product_id").val(),0),quantity=parseInt(this.$el.find(".js_cart_order_product_quantity").val(),0),existing=cart_public_app.router.order_products.findWhere({cart_product_id:cart_product_id});existing?existing.set("quantity",existing.get("quantity")+quantity):cart_public_app.router.order_products.add([{cart_product_id:cart_product_id,quantity:quantity}]);cart_public_app.router.order_products.forEach(function(model){model.save()})}});cart_public_app.router=new(Backbone.Router.extend({el:$(".js_cart"),routes:{"":"index",product_list:"product_list"},initialize:function(){this.order_products=new cart_public_app.collections.order_products},start:function(){Backbone.history.start({pushState:!0,root:"/"+cart_config.prefix+"/"})},index:function(){},product_list:function(){_.each($(".js_cart_add_product"),function(el){new cart_public_app.views.add_product({el:el})})}}));$(function(){cart_public_app.router.start()});